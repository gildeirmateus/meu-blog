---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  
  // DEBUG NO TERMINAL
  console.log("---------------------------------------");
  console.log("⚡ GERANDO ROTAS ESTÁTICAS:");
  posts.forEach(post => console.log(`   ✅ Rota criada para: /blog/${post.slug}`));
  console.log("---------------------------------------");

  return posts.map(post => ({
    params: { slug: post.slug }, 
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title}>
    <article style="max-width: 800px; margin: 0 auto; padding: 2rem;">
        <header style="margin-bottom: 2rem; text-align: center;">
            <p style="color: #666; font-size: 0.9rem;">
                Publicado em {post.data.pubDate ? post.data.pubDate.toLocaleDateString('pt-BR') : 'Data desconhecida'}
            </p>
            <h1 style="font-size: 2.5rem; margin: 0.5rem 0;">{post.data.title}</h1>
            
            {post.data.coverImage && (
                <img 
                    src={post.data.coverImage} 
                    alt={post.data.title}
                    style="width: 100%; height: auto; border-radius: 8px; margin-top: 1rem;" 
                />
            )}
        </header>

        <div class="conteudo-post" style="line-height: 1.8; font-size: 1.1rem;">
            <Content />
        </div>
    </article>
</BaseLayout>